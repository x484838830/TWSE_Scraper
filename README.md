# 台灣股市公開資訊觀測站 - 股東會資料爬蟲 (MOPS Shareholder Meeting Scraper)

>  Python 與 Selenium 的動態網頁爬蟲，客製化查詢指定年份區間與公司代號，並自動抓取、整理、匯出股東會的詳細資料。

透過自動化腳本，使用者只需根據提示輸入條件，即可快速獲取多年的股東會資料，並儲存為 CSV 檔案以便後續分析。

---

## 🌟 功能亮點 (Features)

* **📈 動態年份查詢**：支援三種靈活的年份輸入格式：
    * **單一年份**: `110`
    * **不連續年份**: `109, 111, 113` (逗號分隔)
    * **連續年份區間**: `109~113` (波浪號分隔)

* **🏢 公司代號篩選**：可指定單一公司代號進行精確查詢，或選擇抓取所有公司的資料。

* **🤖 智慧型版面適應**：程式能自動識別公開資訊觀測站因年份不同而變動的網頁表格排版（例如舊版的單列格式與新版的雙列格式），動態調整解析邏輯，確保爬蟲在抓取歷史資料時的穩定性與健壯性。

* **📄 自動化CSV匯出**：所有抓取到的資料會被自動整理並儲存成一個 CSV 檔案，編碼為 `UTF-8 with BOM`，確保使用 Microsoft Excel 開啟時不會出現中文亂碼。

* **📂 智慧檔案命名**：輸出的 CSV 檔案會根據您的查詢條件自動命名，格式為：`查詢日期_查詢年份_公司名稱.csv`，方便管理。例如：`20250919_109至113_2317鴻海資料.csv`。

* **🧹 乾淨的終端機輸出**：已過濾 ChromeDriver 的冗長日誌訊息，提供乾淨、專注於執行進度的命令列介面。

---

## 🚀 環境建置 (Setup)

請依照以下步驟設定您的執行環境。

1.  **下載或複製專案**
    如果您熟悉 Git，請使用 `git clone`。若不熟悉，可以直接下載 ZIP 檔案並解壓縮。

2.  **建立並啟動虛擬環境 (建議)**
    為了避免套件版本衝突，強烈建議在獨立的虛擬環境中執行。
    ```bash
    # 建立虛擬環境
    python -m venv venv

    # 啟動虛擬環境
    # Windows:
    venv\Scripts\activate
    # macOS / Linux:
    source venv/bin/activate
    ```

3.  **安裝依賴套件**
    本專案所需的所有套件都已記錄在 `requirements.txt` 中。
    ```bash
    pip install -r requirements.txt
    ```
    安裝完成後，您的環境就準備好了！

---

## ▶️ 如何執行 (Usage)

1.  確認您已啟動虛擬環境。
2.  在終端機中執行主程式：
    ```bash
    python scrape_twse.py
    ```
3.  根據程式提示，依序輸入您想查詢的**年份**和**公司代號**。

    **執行範例：**
    ```
    --- 股東會資料查詢設定 ---
    Note: 請輸入您想查詢的民國年份(需>=100年)，支援以下格式：
    1. 單一年份: 110
    2. 不連續年份: 109, 111, 113 (可用全形、或半形逗號分隔)
    3. 連續年份: 109~111
    請輸入查詢年份: 109~113

    將會查詢以下年份: [109, 110, 111, 112, 113]

    Note: 您可以指定單一公司，或抓取所有公司。
    請輸入公司代號 (如 2330)，或直接按 Enter 抓取全部: 2317
    ```
4.  程式將開始自動化執行，完成後會在專案目錄下產生對應的 CSV 檔案。

---

## 📄 輸出範例 (Output Example)

* **檔案名稱**: `20250919_109至113_2317鴻海資料.csv`

* **檔案內容 (部分預覽)**:
| 查詢年份 | 公司代號 | 公司名稱 | 股東會類型 | 股東會日期 | 停止過戶起日 | 停止過戶迄日 | 開會地點 | ... |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 113 | 2317 | 鴻海 | 常會 | 113/05/31 | 113/04/02 | 113/05/31 | 新北市土城區自由路2號 | ... |
| 112 | 2317 | 鴻海 | 常會 | 112/05/31 | 112/04/02 | 112/05/31 | 新北市土城區自由路2號 | ... |
| ... | ... | ... | ... | ... | ... | ... | ... | ... |

---

## 📦 依賴套件 (Dependencies)

所有依賴套件皆記錄於 `requirements.txt` 檔案中。

## 📝 注意事項 (Notes)

* 本程式依賴穩定的網路連線。
* 爬蟲程式高度依賴目標網站的結構。若未來「公開資訊觀測站」進行大規模改版，可能會導致此腳本失效，屆時需要進行相對應的維護更新。

---

## 📄 授權 (License)

本專案採用 [MIT License](https://opensource.org/licenses/MIT) 授權。歡迎自由使用、修改與散佈。
